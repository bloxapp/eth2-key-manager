package signer

import (
	"encoding/base64"
	"encoding/hex"
	"encoding/json"
	"fmt"
	"io"
	"os"
	"testing"

	"github.com/attestantio/go-eth2-client/api"
	apiv1bellatrix "github.com/attestantio/go-eth2-client/api/v1/bellatrix"
	apiv1capella "github.com/attestantio/go-eth2-client/api/v1/capella"
	apiv1deneb "github.com/attestantio/go-eth2-client/api/v1/deneb"
	"github.com/attestantio/go-eth2-client/spec"
	"github.com/attestantio/go-eth2-client/spec/bellatrix"
	"github.com/attestantio/go-eth2-client/spec/deneb"
	"github.com/stretchr/testify/require"

	eth2keymanager "github.com/bloxapp/eth2-key-manager"
	"github.com/bloxapp/eth2-key-manager/core"
	prot "github.com/bloxapp/eth2-key-manager/slashing_protection"
	"github.com/bloxapp/eth2-key-manager/wallets"
)

// tested against a ...
func TestBenchmarkBlindedBlockProposalBellatrix(t *testing.T) {
	require.NoError(t, core.InitBLS())

	// fixture
	sk := "2550fa1883222bd14d84ff3794ed555661bc8d00e9305387b308ab4d285105b6"
	pk := "99372f56eab6a56657006a831c6ffbad14a00b143eeb810364b0d6828f85414ae236980f93ef36a689f6d811352a6cf0"
	domain := "00000000e7acb21061790987fa1c1e745cccfb358370b33e8af2b2c18938e6c2"
	blockBase64 := "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"
	sigByts := "ae2605a0b64ababeaa41d27b60df1c716f9c180fb7b16d0d6c33743aa8ce3c387c870beec56dc7641d0824a130f3e68e1153cee3e243b033744092c833ac4fc86832b9158882f85747b1dfc0a9482924e7b40c4fd90fd65bcfe0f0cd75496971"

	// setup KeyVault
	store := inmemStorage()
	options := &eth2keymanager.KeyVaultOptions{}
	options.SetStorage(store)
	options.SetWalletType(core.NDWallet)
	vault, err := eth2keymanager.NewKeyVault(options)
	require.NoError(t, err)
	wallet, err := vault.Wallet()
	require.NoError(t, err)
	k, err := core.NewHDKeyFromPrivateKey(_byteArray(sk), "")
	require.NoError(t, err)
	acc := wallets.NewValidatorAccount("1", k, nil, "", vault.Context)
	require.NoError(t, wallet.AddValidatorAccount(acc))

	// setup signer
	signer := NewSimpleSigner(wallet, &prot.NoProtection{}, core.PraterNetwork)

	// decode block
	blk := &apiv1bellatrix.BlindedBeaconBlock{}
	blockBytes, err := base64.StdEncoding.DecodeString(blockBase64)
	require.NoError(t, err)
	require.NoError(t, blk.UnmarshalSSZ(blockBytes))

	versionedBlindedBeaconBlock := &api.VersionedBlindedBeaconBlock{
		Version:   spec.DataVersionBellatrix,
		Bellatrix: blk,
	}

	sig, _, err := signer.SignBlindedBeaconBlock(versionedBlindedBeaconBlock, _byteArray32(domain), _byteArray(pk))
	require.NoError(t, err)
	require.EqualValues(t, _byteArray(sigByts), sig)
}

// tested against a real block and sig from the Sepolia testnet (slot 1861337)
func TestBenchmarkBlindedBlockProposalCapella(t *testing.T) {
	require.NoError(t, core.InitBLS())

	// fixture
	sk := "17f8b2dbb824318970a9c82b4f5456d598342dac248f89c252dd30bb9e85e43c"
	pk := "81d6fc2f01633e8eab3ba4d72588e14f45b00e68ab887bdd4ec5e8558965db21189310df973837106216777b07fc0805"
	domain := "0000000047eb72b3be36f08feffcaba760f0a2ed78c1a85f0654941a0d19d0fa"
	blkJSON := []byte(`{"slot":"1861337","proposer_index":"1610","parent_root":"0x353f35e506b07b6a20dd5d24c92b6dfda1b9e221848963d7a40cb7fe4e23c35a","state_root":"0x8e9cfedb909c4c9bbc52ca4174b279d31ffe40a667077c7b31a66bbd1a66d0be","body":{"randao_reveal":"0xb019a2ef4b7763c7bd5a9b3dbe00ba38cdfb6ee0fcecfe4a7301687973717f7c193072a3ebd70de3aed153f960b11fc40037b8164542e1364a31489ff7a0a1119ef46bc2ea099886446cba3acc4721a2534c292f6eeb650719f32477707aab3e","eth1_data":{"deposit_root":"0x9df92d765b5aa041fd4bbe8d5878eb89290efa78e444c1a603eecfae2ea05fa4","deposit_count":"403","block_hash":"0x1ee29c95ea816db342e04fbd1f00cb14940a45d025d2d14bf0d33187d8f4d5ea"},"graffiti":"0x626c6f787374616b696e672e636f6d0000000000000000000000000000000000","proposer_slashings":[],"attester_slashings":[],"attestations":[{"aggregation_bits":"0xffffffffffffff37","data":{"slot":"1861336","index":"0","beacon_block_root":"0x353f35e506b07b6a20dd5d24c92b6dfda1b9e221848963d7a40cb7fe4e23c35a","source":{"epoch":"58165","root":"0x5c0a59daecb2f509e0d5a038da44c55ef5827b0b979e6e397cc7f5846f9f3f4c"},"target":{"epoch":"58166","root":"0x835469d3b4348c2f5c2964afaac731acc0117eb0f5cec64bf166ab26847f77a8"}},"signature":"0x991b97e124a8dc672d135c167f030ceff9ab500dfd9a8bb79e199a303bfa54cebc205e396a16466e51d54cb7e0d981eb0eb03295bdb39b69d9559421aeea22838d22732d66ea79d3bebb8a8a335679491b60ad6d815318cbfd92a1a867c70255"}],"deposits":[],"voluntary_exits":[],"sync_aggregate":{"sync_committee_bits":"0xfffffbfffffffffffffffcffffdfffffffffffffffefffffffffffff7ffdffffbfffffffffffefffffebfffffffffffffffffffdff7fffffffffffffffffffff","sync_committee_signature":"0x91713624034f3c1e37baa3de1d082883c6e44cc830f4ecf0ca58cc06153aba97ca4539edfdb0f49a0d18b354f585422e114feb07b689db0a47ee72231d8e6fb2970663f518ca0a3fda0e701cd4662405c4f2fa9fdac0533c790f92404240432e"},"execution_payload_header":{"parent_hash":"0x4b37c3a4f001b91cfcac61b7f6bdfd2218525e4f421a4ab52fa513b00e76ab6f","fee_recipient":"0x0f35b0753e261375c9a6cb44316b4bdc7e765509","state_root":"0xc9d0b31cc38141d01998220dcc0e7830994e6a1d11fa3a26d7d113df82c1a53a","receipts_root":"0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421","logs_bloom":"0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","prev_randao":"0x251fdfd6ebef77085f24016900debbd334e67cf51ee48d959f01ef12698a49a5","block_number":"3031542","gas_limit":"30000000","gas_used":"0","timestamp":"1678069644","extra_data":"0xd883010b02846765746888676f312e32302e31856c696e7578","base_fee_per_gas":"7","block_hash":"0x4cb1ca5a2947972cb018416fe4489b9daf674d5be97fd2ebb6de1a1608226733","transactions_root":"0x7ffe241ea60187fdb0187bfa22de35d1f9bed7ab061d9401fd47e34a54fbede1","withdrawals_root":"0xb8edfc6f0dc2564cff3102471bef1e02db94346c692eb81decf0dec63c1c69f5"},"bls_to_execution_changes":[]}}`)
	sigByts := "9321eb1d373e75bb0b746a8c4b6f62285cccb17f2105a1f4f968534902131a29fffd5b54a0012c34c8600639609c46ab05a23fe8f89cdd252df680883ccb94073d9b852680bba6c5f5166edcd6024c9ef489c555d1cde994fdd7010fb394e45d"

	// setup KeyVault
	store := inmemStorage()
	options := &eth2keymanager.KeyVaultOptions{}
	options.SetStorage(store)
	options.SetWalletType(core.NDWallet)
	vault, err := eth2keymanager.NewKeyVault(options)
	require.NoError(t, err)
	wallet, err := vault.Wallet()
	require.NoError(t, err)
	k, err := core.NewHDKeyFromPrivateKey(_byteArray(sk), "")
	require.NoError(t, err)
	acc := wallets.NewValidatorAccount("1", k, nil, "", vault.Context)
	require.NoError(t, wallet.AddValidatorAccount(acc))

	// setup signer
	signer := NewSimpleSigner(wallet, &prot.NoProtection{}, core.PraterNetwork)

	// decode block
	blk := &apiv1capella.BlindedBeaconBlock{}
	require.NoError(t, json.Unmarshal(blkJSON, blk))

	versionedBlindedBeaconBlock := &api.VersionedBlindedBeaconBlock{
		Version: spec.DataVersionCapella,
		Capella: blk,
	}

	sig, _, err := signer.SignBlindedBeaconBlock(versionedBlindedBeaconBlock, _byteArray32(domain), _byteArray(pk))
	fmt.Println(hex.EncodeToString(sig))
	require.NoError(t, err)
	require.EqualValues(t, _byteArray(sigByts), sig)
}

func TestBenchmarkBlindedBlockProposalDeneb(t *testing.T) {
	require.NoError(t, core.InitBLS())

	// fixture
	sk := "17f8b2dbb824318970a9c82b4f5456d598342dac248f89c252dd30bb9e85e43c"
	pk := "81d6fc2f01633e8eab3ba4d72588e14f45b00e68ab887bdd4ec5e8558965db21189310df973837106216777b07fc0805"
	domain := "00000000ec9c75d44197ee8cb111b5113efa166654b791baefe8fb222a630fc2"
	blockRoot := "7c4a5b95737cdb6c88f790439e32e777fdb6e8bc2ec327ba64adf0fb91d1c412"
	sigByts := "925f9c30991cb035da8dbcf2571f09867ea1c0b7ef0ead466725cc50460bf41b5b24ec8ca8c8179b16b85e222559f2db0ea6d3635f0a271335457504f5cf8760fd859036cf1d037b3b545674468cb4553fd6934ed25c0840b72d7bb3dee26500"

	blindedBlkJSON, err := os.Open("dencun-devnet-12-deneb-blinded-block.json")
	require.NoError(t, err)
	defer blindedBlkJSON.Close()

	blindedBlkBytes, err := io.ReadAll(blindedBlkJSON)
	require.NoError(t, err)

	blindedBeaconBlock := &apiv1deneb.BlindedBeaconBlock{}
	require.NoError(t, json.Unmarshal(blindedBlkBytes, blindedBeaconBlock))

	blindedSSZ, err := blindedBeaconBlock.MarshalSSZ()
	require.NoError(t, err)

	unmarshalBlindedBeaconBlock := &apiv1deneb.BlindedBeaconBlock{}
	require.NoError(t, unmarshalBlindedBeaconBlock.UnmarshalSSZ(blindedSSZ))

	blindedRoot, err := unmarshalBlindedBeaconBlock.HashTreeRoot()
	require.NoError(t, err)

	blkJSON, err := os.Open("dencun-devnet-12-deneb-block.json")
	require.NoError(t, err)
	defer blkJSON.Close()

	blkBytes, err := io.ReadAll(blkJSON)
	require.NoError(t, err)

	beaconBlock := &deneb.BeaconBlock{}
	require.NoError(t, json.Unmarshal(blkBytes, beaconBlock))

	ssz, err := beaconBlock.MarshalSSZ()
	require.NoError(t, err)

	unmarshalBeaconBlock := &deneb.BeaconBlock{}
	require.NoError(t, unmarshalBeaconBlock.UnmarshalSSZ(ssz))

	root, err := unmarshalBeaconBlock.HashTreeRoot()
	require.NoError(t, err)

	require.EqualValues(t, _byteArray(blockRoot), blindedRoot[:])
	require.EqualValues(t, _byteArray(blockRoot), root[:])

	// setup KeyVault
	store := inmemStorage()
	options := &eth2keymanager.KeyVaultOptions{}
	options.SetStorage(store)
	options.SetWalletType(core.NDWallet)
	vault, err := eth2keymanager.NewKeyVault(options)
	require.NoError(t, err)
	wallet, err := vault.Wallet()
	require.NoError(t, err)
	k, err := core.NewHDKeyFromPrivateKey(_byteArray(sk), "")
	require.NoError(t, err)
	acc := wallets.NewValidatorAccount("1", k, nil, "", vault.Context)
	require.NoError(t, wallet.AddValidatorAccount(acc))

	// setup signer
	signer := NewSimpleSigner(wallet, &prot.NoProtection{}, core.PraterNetwork)

	versionedBlindedBeaconBlock := &api.VersionedBlindedBeaconBlock{
		Version: spec.DataVersionDeneb,
		Deneb:   blindedBeaconBlock,
	}

	sig, _, err := signer.SignBlindedBeaconBlock(versionedBlindedBeaconBlock, _byteArray32(domain), _byteArray(pk))
	fmt.Println(hex.EncodeToString(sig))
	require.NoError(t, err)
	require.EqualValues(t, _byteArray(sigByts), sig)
}

// Test slashing by signing first beacon block and then blinded beacon block
func TestDoubleProposalsSigning_Regular_Blinded(t *testing.T) {
	require.NoError(t, core.InitBLS())

	// fixture
	sk := "2550fa1883222bd14d84ff3794ed555661bc8d00e9305387b308ab4d285105b6"
	pk := "99372f56eab6a56657006a831c6ffbad14a00b143eeb810364b0d6828f85414ae236980f93ef36a689f6d811352a6cf0"
	domain := "00000000e7acb21061790987fa1c1e745cccfb358370b33e8af2b2c18938e6c2"
	blockBase64 := "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"
	blindedBlockBase64 := "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"
	sigByts := "ae2605a0b64ababeaa41d27b60df1c716f9c180fb7b16d0d6c33743aa8ce3c387c870beec56dc7641d0824a130f3e68e1153cee3e243b033744092c833ac4fc86832b9158882f85747b1dfc0a9482924e7b40c4fd90fd65bcfe0f0cd75496971"

	// setup KeyVault
	store := inmemStorage()
	options := &eth2keymanager.KeyVaultOptions{}
	options.SetStorage(store)

	protector := prot.NewNormalProtection(store)

	options.SetWalletType(core.NDWallet)
	vault, err := eth2keymanager.NewKeyVault(options)
	require.NoError(t, err)
	wallet, err := vault.Wallet()
	require.NoError(t, err)
	k, err := core.NewHDKeyFromPrivateKey(_byteArray(sk), "")
	require.NoError(t, err)
	acc := wallets.NewValidatorAccount("1", k, nil, "", vault.Context)
	require.NoError(t, wallet.AddValidatorAccount(acc))

	// setup signer
	signer := NewSimpleSigner(wallet, protector, core.PraterNetwork)

	// decode block
	blk := &bellatrix.BeaconBlock{}
	blockBytes, err := base64.StdEncoding.DecodeString(blockBase64)
	require.NoError(t, err)
	require.NoError(t, blk.UnmarshalSSZ(blockBytes))

	// minimal slashing protection
	require.NoError(t, protector.UpdateHighestProposal(_byteArray(pk), blk.Slot-1))

	versionedBeaconBlock := &spec.VersionedBeaconBlock{
		Version:   spec.DataVersionBellatrix,
		Bellatrix: blk,
	}

	// decode blinded block
	blindedBlk := &apiv1bellatrix.BlindedBeaconBlock{}
	blockBytes, err = base64.StdEncoding.DecodeString(blindedBlockBase64)
	require.NoError(t, err)
	require.NoError(t, blindedBlk.UnmarshalSSZ(blockBytes))

	versionedBlindedBeaconBlock := &api.VersionedBlindedBeaconBlock{
		Version:   spec.DataVersionBellatrix,
		Bellatrix: blindedBlk,
	}

	sig, _, err := signer.SignBeaconBlock(versionedBeaconBlock, _byteArray32(domain), _byteArray(pk))
	require.NoError(t, err)
	require.EqualValues(t, _byteArray(sigByts), sig)

	_, _, err = signer.SignBlindedBeaconBlock(versionedBlindedBeaconBlock, _byteArray32(domain), _byteArray(pk))
	require.Error(t, err)
	require.EqualError(t, err, "slashable proposal (HighestProposalVote), not signing")
}

// Test slashing by signing first blinded beacon block and then beacon block
func TestDoubleProposalsSigning_Blinded_Regular(t *testing.T) {
	require.NoError(t, core.InitBLS())

	// fixture
	sk := "2550fa1883222bd14d84ff3794ed555661bc8d00e9305387b308ab4d285105b6"
	pk := "99372f56eab6a56657006a831c6ffbad14a00b143eeb810364b0d6828f85414ae236980f93ef36a689f6d811352a6cf0"
	domain := "00000000e7acb21061790987fa1c1e745cccfb358370b33e8af2b2c18938e6c2"
	blockBase64 := "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"
	blindedBlockBase64 := "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"
	sigByts := "ae2605a0b64ababeaa41d27b60df1c716f9c180fb7b16d0d6c33743aa8ce3c387c870beec56dc7641d0824a130f3e68e1153cee3e243b033744092c833ac4fc86832b9158882f85747b1dfc0a9482924e7b40c4fd90fd65bcfe0f0cd75496971"

	// setup KeyVault
	store := inmemStorage()
	options := &eth2keymanager.KeyVaultOptions{}
	options.SetStorage(store)

	protector := prot.NewNormalProtection(store)

	options.SetWalletType(core.NDWallet)
	vault, err := eth2keymanager.NewKeyVault(options)
	require.NoError(t, err)
	wallet, err := vault.Wallet()
	require.NoError(t, err)
	k, err := core.NewHDKeyFromPrivateKey(_byteArray(sk), "")
	require.NoError(t, err)
	acc := wallets.NewValidatorAccount("1", k, nil, "", vault.Context)
	require.NoError(t, wallet.AddValidatorAccount(acc))

	// setup signer
	signer := NewSimpleSigner(wallet, protector, core.PraterNetwork)

	// decode block
	blk := &bellatrix.BeaconBlock{}
	blockBytes, err := base64.StdEncoding.DecodeString(blockBase64)
	require.NoError(t, err)
	require.NoError(t, blk.UnmarshalSSZ(blockBytes))

	// minimal slashing protection
	require.NoError(t, protector.UpdateHighestProposal(_byteArray(pk), blk.Slot-1))

	versionedBeaconBlock := &spec.VersionedBeaconBlock{
		Version:   spec.DataVersionBellatrix,
		Bellatrix: blk,
	}

	// decode blinded block
	blindedBlk := &apiv1bellatrix.BlindedBeaconBlock{}
	blockBytes, err = base64.StdEncoding.DecodeString(blindedBlockBase64)
	require.NoError(t, err)
	require.NoError(t, blindedBlk.UnmarshalSSZ(blockBytes))

	versionedBlindedBeaconBlock := &api.VersionedBlindedBeaconBlock{
		Version:   spec.DataVersionBellatrix,
		Bellatrix: blindedBlk,
	}

	sig, _, err := signer.SignBlindedBeaconBlock(versionedBlindedBeaconBlock, _byteArray32(domain), _byteArray(pk))
	require.NoError(t, err)
	require.EqualValues(t, _byteArray(sigByts), sig)

	_, _, err = signer.SignBeaconBlock(versionedBeaconBlock, _byteArray32(domain), _byteArray(pk))
	require.Error(t, err)
	require.EqualError(t, err, "slashable proposal (HighestProposalVote), not signing")
}
